<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:MediaVault.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
        x:Class="MediaVault.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Icon="/Assets/avalonia-logo.ico"
        Title="MediaVault">

	<Design.DataContext>
		<vm:MainWindowViewModel/>
	</Design.DataContext>

	<DockPanel>
		<StackPanel DockPanel.Dock="Top">
			<!-- <Button Content="Налаштування" Command="{Binding SettingsCommand}" Margin="0,0,5,0"/> -->
			<Button Content="Обрати директорію" Command="{Binding ScanDirectoryCommand}" Margin="10,10,10,10"/>
			<Button Content="Історія перегляду" Click="OnViewingHistoryClick" Margin="10,10,10,10"/>
			<!-- <TextBox x:Name="SearchBox" Width="200" VerticalAlignment="Center" /> -->
			<!-- <Button Content="Search" Command="{Binding SearchCommand}"/> -->
			<ToggleButton Content="Список" IsChecked="{Binding IsListView}" Margin="10,5,10,5"/>
			<ToggleButton Content="Галерея" IsChecked="{Binding IsGalleryView}" Margin="10,0,10,5"/>
		</StackPanel>

		<!-- <StackPanel Width="200" DockPanel.Dock="Left">
			<TextBlock Text="Categories" FontWeight="Bold" Margin="5"/>
			<ListBox ItemsSource="{Binding Categories}"/>
		</StackPanel> -->

		<ScrollViewer>
			<Panel>
				<!-- Список -->
				<ListBox Name="MediaListBox"
                         ItemsSource="{Binding MediaFiles}"
                         SelectedItem="{Binding SelectedMediaFile, Mode=TwoWay}"
                         DoubleTapped="OnMediaItemDoubleTapped"
                         IsVisible="{Binding IsListView}">
					<ListBox.ItemTemplate>
						<DataTemplate>
							<StackPanel Orientation="Horizontal" Margin="5">
								<Image Source="{Binding CoverImagePath}" Width="48" Height="48" Margin="0,0,10,0"/>
								<StackPanel>
									<TextBlock Text="{Binding Title}" FontWeight="Bold"/>
									<!-- <TextBlock Text="{Binding Genre}" FontSize="12"/>
									<TextBlock Text="{Binding ReleaseYear}" FontSize="12"/> -->
								</StackPanel>
							</StackPanel>
						</DataTemplate>
					</ListBox.ItemTemplate>
				</ListBox>

				<!-- Галерея (тепер це ListBox для підтримки вибору) -->
				<ListBox Name="MediaGallery"
                         ItemsSource="{Binding MediaFiles}"
                         SelectedItem="{Binding SelectedMediaFile, Mode=TwoWay}"
                         DoubleTapped="OnMediaItemDoubleTapped"
                         IsVisible="{Binding IsGalleryView}">
					<ListBox.ItemsPanel>
						<ItemsPanelTemplate>
							<WrapPanel Orientation="Horizontal" />
						</ItemsPanelTemplate>
					</ListBox.ItemsPanel>
					<ListBox.ItemTemplate>
						<DataTemplate>
							<StackPanel Margin="10" Width="180">
								<Border BorderBrush="Gray" BorderThickness="1">
									<Image Source="{Binding CoverImagePath}" Width="160" Height="120"/>
								</Border>
								<TextBlock Text="{Binding Title}" HorizontalAlignment="Center" Margin="0,5,0,0"/>
							</StackPanel>
						</DataTemplate>
					</ListBox.ItemTemplate>
				</ListBox>
			</Panel>
		</ScrollViewer>
	</DockPanel>
</Window>